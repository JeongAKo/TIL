# 메모리 구조

프로그램의 실행을 위해 운영체제로 부터 메모리 공간을 할당 받는다

![images_tonic523_post_185807be-aaee-47e4-9262-a664d8eca59d_image.png](/Users/daisy/Downloads/images_tonic523_post_185807be-aaee-47e4-9262-a664d8eca59d_image.png)

##### 데이터

- 전역변수와 정적변수

- 프로그램이 시작하고 끝날때 까지 메모리에 계속 남아있는다

##### 힙

- 동적 메모리 할당(프로그래머가 직접 할당과 해제) / 런타임중 크기 결정 (제대로 해지 해주지 않으면 memory leak 발생) (**객체, 배열...동적으로 할당된 변수...참조타입**)

- GC(가비지 컬렉터)가 자동으로 메모리 관리 해준다 

- 메모리가 낮은주소에서 높은주소로

- 시스템 메모리(or 가상메모리)의 크기 내에서 큰 사이즈

- 스택에 비해 메모리 할당/ 해제가 느리다

##### 스택

- 정적 메모리 할당(**지역변수, 매개변수, 함수의 호출과 관계되는**... 값 형식 저장)

- 함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸(자동관리)

- LIFO (push/ pop)

- 메모리가 높은주소에서 낮은주소로

- 이미 할당 되어있는 공간을 사용하기 때문에 빠른 속도

- 크기를 컴파일시에 결정하므로 너무 크게 못잡는다 (제한적인 크기)

스택과 힙은 같은 공간을 사용한다.

그래서 Stack 영역이 클 수록 Heap 영역이 작아지고, 반대로 Heap 영역이 클수록 Stack 영역이 작아진다. (반비례) 이유는 오버플로우를 방지하기 위해

##### 스택과 힙을 나눈 목적은?

프로그램 상에서 얼마나 메모리가 필요할지 모르는 상태이고

미리 모두 할당해놓는것은 쓰이지 않을 메모르까지 할당되어있는 비효율적인 상태에 놓일 수 있으므로..

> 컴파일: 인간이 이해할 수 있는 언어로 작성된 소스 코드**(고수준 언어 : C, C++, Java 등)를 **CPU가 이해할 수 있는 언어**(저수준 언어 : 기계어)로 **번역(변환)하는 작업**을 말한다.

스레드끼리 프로세스의 code/ data/ heap을 공유하지만 stack은 독립적으로 할당

## 함수 호출 방법은 크게 두가지

##### Call by value(값에 의한 호출)

- 장점 : 복사하여 처리하기 때문에 안전하다. 원래의 값이 보존이 된다.
- 단점 : 복사를 하기 때문에 메모리가 사용량이 늘어난다.

##### Call by reference(참조에 의한 호출)

- 장점 : 복사하지 않고 직접 참조를 하기에 빠르다.
- 단점 : 직접 참조를 하기에 원래 값이 영향을 받는다.(리스크)

##### 헷갈헷갈!

Call by reference???? 이게 뭐지?  Swift는 기본적으로 call by value를 쓰기때문에 이해가 안갔었다

[[javascript] 콜스택/메모리힙 구조, 데이터 저장/참조 원리 — Charming-Tech](https://charming-kyu.tistory.com/19)

[[Java] 메모리 구조 메소드(Method), 스택(Stack), 힙(Heap) 영역에 대하여](https://coding-factory.tistory.com/830)
